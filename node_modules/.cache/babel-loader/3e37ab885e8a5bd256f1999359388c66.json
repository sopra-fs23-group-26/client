{"ast":null,"code":"import _asyncToGenerator from \"/home/heqing/Downloads/SELAB/M3/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/home/heqing/Downloads/SELAB/M3/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/home/heqing/Downloads/SELAB/M3/client/src/components/views/Platform.js\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport _regeneratorRuntime from \"/home/heqing/Downloads/SELAB/M3/client/node_modules/@babel/runtime/regenerator/index.js\";\nimport { useEffect, useState } from 'react';\nimport { api, handleError } from 'helpers/api';\nimport { Spinner } from 'components/ui/Spinner';\nimport { Button } from 'components/ui/Button';\nimport { useHistory } from 'react-router-dom';\nimport BaseContainer from \"components/ui/BaseContainer\";\nimport PropTypes from \"prop-types\";\nimport \"styles/views/Game.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Player = function Player(_ref) {\n  _s();\n\n  var user = _ref.user;\n  var history = useHistory();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"player container\",\n    onClick: function onClick() {\n      return history.push(\"/profile?username=\".concat(user.username));\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"player username\",\n      children: user.username\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Player, \"9cZfZ04734qoCGIctmKX7+sX6eU=\", false, function () {\n  return [useHistory];\n});\n\n_c = Player;\nPlayer.propTypes = {\n  user: PropTypes.object\n};\n\nvar Platform = function Platform() {\n  _s2();\n\n  // use react-router-dom's hook to access the history\n  var history = useHistory(); // define a state variable (using the state hook).\n  // if this variable changes, the component will re-render, but the variable will\n  // keep its value throughout render cycles.\n  // a component can have as many state variables as you like.\n  // more information can be found under https://reactjs.org/docs/hooks-state.html\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var logout = function logout() {\n    var userinfo = JSON.parse(localStorage.getItem('userinfo'));\n    api.post('/logout/' + userinfo.username);\n    localStorage.removeItem('token');\n    history.push('/');\n  };\n\n  var gotoProfile = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var userinfo, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              userinfo = JSON.parse(localStorage.getItem('userinfo'));\n              _context.next = 4;\n              return api.get('/user/' + userinfo.username);\n\n            case 4:\n              response = _context.sent;\n              _context.next = 7;\n              return new Promise(function (resolve) {\n                return setTimeout(resolve, 500);\n              });\n\n            case 7:\n              setUser(response.data);\n              history.push(\"/profile?username=\".concat(user.username));\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](0);\n              history.push('/');\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 11]]);\n    }));\n\n    return function gotoProfile() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(BaseContainer, {\n    className: \"game container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Game Platform\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, _this), /*#__PURE__*/_jsxDEV(Button, {\n      width: \"100%\",\n      onClick: function onClick() {\n        return gotoProfile();\n      },\n      children: \"Profile\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, _this), /*#__PURE__*/_jsxDEV(Button, {\n      width: \"100%\",\n      onClick: function onClick() {\n        return logout();\n      },\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, _this);\n};\n\n_s2(Platform, \"m7ZE1S6lfGWQVWn+/ui1tbXbqwI=\", false, function () {\n  return [useHistory];\n});\n\n_c2 = Platform;\nexport default Platform;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Player\");\n$RefreshReg$(_c2, \"Platform\");","map":{"version":3,"sources":["/home/heqing/Downloads/SELAB/M3/client/src/components/views/Platform.js"],"names":["useEffect","useState","api","handleError","Spinner","Button","useHistory","BaseContainer","PropTypes","Player","user","history","push","username","propTypes","object","Platform","setUser","logout","userinfo","JSON","parse","localStorage","getItem","post","removeItem","gotoProfile","get","response","Promise","resolve","setTimeout","data"],"mappings":"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","sourcesContent":["import {useEffect, useState} from 'react';\nimport {api, handleError} from 'helpers/api';\nimport {Spinner} from 'components/ui/Spinner';\nimport {Button} from 'components/ui/Button';\nimport {useHistory} from 'react-router-dom';\nimport BaseContainer from \"components/ui/BaseContainer\";\nimport PropTypes from \"prop-types\";\nimport \"styles/views/Game.scss\";\n\nconst Player = ({user}) => {\n  const history = useHistory();\n  return (\n    <div className=\"player container\" onClick={() => history.push(`/profile?username=${user.username}`)}>\n      <div className=\"player username\" >{user.username}</div>\n    </div>\n  )\n};\n\nPlayer.propTypes = {\n  user: PropTypes.object\n};\n\nconst Platform = () => {\n  // use react-router-dom's hook to access the history\n  const history = useHistory();\n\n  // define a state variable (using the state hook).\n  // if this variable changes, the component will re-render, but the variable will\n  // keep its value throughout render cycles.\n  // a component can have as many state variables as you like.\n  // more information can be found under https://reactjs.org/docs/hooks-state.html\n  const [user, setUser] = useState(null);\n\n  const logout = () => {\n    let userinfo = JSON.parse(localStorage.getItem('userinfo'))\n    api.post('/logout/' + userinfo.username);\n    localStorage.removeItem('token');\n    history.push('/');\n  }\n\n  const gotoProfile = async () => {\n    try {\n      const userinfo = JSON.parse(localStorage.getItem('userinfo'))\n      const response = await api.get('/user/' + userinfo.username);\n      await new Promise(resolve => setTimeout(resolve, 500));\n      setUser(response.data);\n      history.push(`/profile?username=${user.username}`);\n    } catch (error) {\n      history.push('/');\n    }\n  }\n\n\n  return (\n    <BaseContainer className=\"game container\">\n        <h2>Game Platform</h2>\n        <Button\n          width=\"100%\"\n          onClick={() => gotoProfile()}\n        >\n          Profile\n        </Button>\n\n        <Button\n          width=\"100%\"\n          onClick={() => logout()}\n        >\n          Logout\n        </Button>\n    </BaseContainer>\n  );\n}\n\nexport default Platform;\n"]},"metadata":{},"sourceType":"module"}